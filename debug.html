<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
  </head>
  <body>
    <p>
      Username: <input id="username" value="collabonline\openup" />
    </p>
    <p>
      Password: <input id="password"/>
    </p>
    <p>
      <button id="authenticate">Authenticate</button>
    </p>
    <p>
      Token: <textarea id="token"></textarea>
    </p>
    <p>
      <button id="create">Create ticket</button>
    </p>
    <script>

      $("#authenticate").on("click", function() {
        var loginData = {
          username: $("#username").val(),
          password: $("#password").val()
        };

        var myPromise = $.ajax({
          type: "POST",
          accepts: "application/json",
          crossDomain: true,
          dataType: "json",
          data: loginData,
          cache: false,
          url: "https://api.collaboratoronline.com/webAPIConsumer/api/MobileToken/GetTokenForUser",
          headers: { "Authorization": "Bearer ", "deviceId":  "COMUNITY", "appVersion": "1.1.6" }
        }).done(function(something, sthelse) {
          $("#token").val(something);
          console.log(something, sthelse)
        }).fail((something, sthelse) => console.error(something, sthelse));
      });

      $("#create").on("click", function() {
        var requestData = {
          TemplateId: 9,
          BPID: 3,
          PercentComplete: 100,
          Comments: "Feedback done from OpenUp",
          FormFields: [
            { FieldID: "F1", FieldValue: "Roads"},
            { FieldID: "F2", FieldValue: "Mr Test"},
            { FieldID: "F3", FieldValue: "User"},
            { FieldID: "F4", FieldValue: "0792816737"},
            { FieldID: "F5", FieldValue: "user@example.com"},
            { FieldID: "F6", FieldValue: "12345"},
            { FieldID: "F7", FieldValue: "Geen Straat"},
            { FieldID: "F8", FieldValue: "123"},
            { FieldID: "F9", FieldValue: "Daar"},
            { FieldID: "F10", FieldValue: "Iets is fout"},
            { FieldID: "F11", FieldValue: ""},
            { FieldID: "F12", FieldValue: "12.3, 45.6"},
            { FieldID: "F13", FieldValue: "2020-01-01"},
            { FieldID: "F15", FieldValue: "Initial"},
          ],

        };

        var myPromise = $.ajax({
          type: "POST",
          accepts: "application/json",
          crossDomain: true,
          dataType: "json",
          data: requestData,
          cache: false,
          url: "https://api.collaboratoronline.com/webAPIConsumer/api/Task/SaveNewTaskFeedback",
          headers: {
            "Authorization": `Bearer ${$("#token").val()}`,
            "deviceId":  "COMUNITY",
            "appVersion": "1.1.6"
          }
        }).done(function(something, sthelse) {
          $("#token").val(something);
          console.log(something, sthelse)
        }).fail((something, sthelse) => console.error(something, sthelse));
      });


    </script>
  </body>
</html>
